[2023-03-21T02:02:09.582+0000] {taskinstance.py:1084} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongDim.ValidateSongDim manual__2023-03-18T04:27:11.434896+00:00 [queued]>
[2023-03-21T02:02:09.588+0000] {taskinstance.py:1084} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongDim.ValidateSongDim manual__2023-03-18T04:27:11.434896+00:00 [queued]>
[2023-03-21T02:02:09.589+0000] {taskinstance.py:1282} INFO - 
--------------------------------------------------------------------------------
[2023-03-21T02:02:09.589+0000] {taskinstance.py:1283} INFO - Starting attempt 5 of 6
[2023-03-21T02:02:09.590+0000] {taskinstance.py:1284} INFO - 
--------------------------------------------------------------------------------
[2023-03-21T02:02:09.597+0000] {taskinstance.py:1303} INFO - Executing <Task(PythonOperator): ValidateAndLoadSongDim.ValidateSongDim> on 2023-03-18 04:27:11.434896+00:00
[2023-03-21T02:02:09.603+0000] {standard_task_runner.py:55} INFO - Started process 16192 to run task
[2023-03-21T02:02:09.612+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'Spotify_Data_ETL', 'ValidateAndLoadSongDim.ValidateSongDim', 'manual__2023-03-18T04:27:11.434896+00:00', '--job-id', '1624', '--raw', '--subdir', 'DAGS_FOLDER/spotifydag.py', '--cfg-path', '/tmp/tmp8090_r01']
[2023-03-21T02:02:09.613+0000] {standard_task_runner.py:83} INFO - Job 1624: Subtask ValidateAndLoadSongDim.ValidateSongDim
[2023-03-21T02:02:09.688+0000] {task_command.py:388} INFO - Running <TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongDim.ValidateSongDim manual__2023-03-18T04:27:11.434896+00:00 [running]> on host 1fd7b08731f2
[2023-03-21T02:02:09.763+0000] {taskinstance.py:1511} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Ananta Moharana
AIRFLOW_CTX_DAG_ID=Spotify_Data_ETL
AIRFLOW_CTX_TASK_ID=ValidateAndLoadSongDim.ValidateSongDim
AIRFLOW_CTX_EXECUTION_DATE=2023-03-18T04:27:11.434896+00:00
AIRFLOW_CTX_TRY_NUMBER=5
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-03-18T04:27:11.434896+00:00
[2023-03-21T02:02:09.765+0000] {logging_mixin.py:137} INFO - {"song_name":{"0":"Bebe Dame","2":"CHORRITO PA LAS ANIMAS","3":"Romantic Homicide","4":"Tormenta (feat. Bad Bunny)","6":"Me Porto Bonito","8":"Just Wanna Rock","9":"Rara Vez","11":"MERCHO","14":"Bones","15":"Sure Thing","16":"Fin de Semana","18":"La Jumpa","20":"Feliz Cumplea\u00f1os Ferxxo","21":"Snooze","22":"Coco Chanel","24":"I Ain't Worried","25":"ceilings","26":"Quevedo: Bzrp Music Sessions, Vol. 52","28":"Players","29":"Another Love","30":"golden hour","31":"Starboy","33":"I Wanna Be Yours","34":"Escapism.","36":"Last Night","37":"Hey Mor","39":"OMG","40":"La Bachata","41":"AMG","44":"Until I Found You (with Em Beihold) - Em Beihold Version","46":"PRC","48":"I'm Good (Blue)","50":"Shorty Party","52":"Here With Me","53":"All Of The Girls You Loved Before","54":"Die For You","55":"Unholy (feat. Kim Petras)","57":"Anti-Hero","58":"Set Me Free Pt.2","59":"Calm Down (with Selena Gomez)","61":"Yandel 150","63":"Ella Baila Sola","65":"Creepin' (with The Weeknd & 21 Savage)","68":"As It Was","69":"Shakira: Bzrp Music Sessions, Vol. 53","71":"Die For You (with Ariana Grande) - Remix","73":"Boy's a liar Pt. 2","75":"Kill Bill","76":"TQG","78":"Flowers"},"explicit":{"0":false,"2":true,"3":false,"4":true,"6":true,"8":true,"9":false,"11":false,"14":false,"15":false,"16":false,"18":true,"20":false,"21":true,"22":true,"24":false,"25":false,"26":false,"28":true,"29":true,"30":false,"31":true,"33":false,"34":true,"36":true,"37":false,"39":false,"40":false,"41":true,"44":false,"46":true,"48":true,"50":true,"52":false,"53":false,"54":false,"55":false,"57":false,"58":true,"59":false,"61":true,"63":false,"65":true,"68":false,"69":false,"71":false,"73":false,"75":false,"76":true,"78":false},"acousticness":{"0":0.299,"2":0.114,"3":0.453,"4":0.458,"6":0.0901,"8":0.0652,"9":0.176,"11":0.431,"14":0.0201,"15":0.0267,"16":0.0628,"18":0.111,"20":0.0863,"21":0.141,"22":0.0427,"24":0.0988,"25":0.473,"26":0.0125,"28":0.03,"29":0.717,"30":0.653,"31":0.141,"33":0.136,"34":0.138,"36":0.467,"37":0.00302,"39":0.357,"40":0.583,"41":0.152,"44":0.777,"46":0.0965,"48":0.00383,"50":0.328,"52":0.534,"53":0.707,"54":0.111,"55":0.011,"57":0.13,"58":0.115,"59":0.382,"61":0.0492,"63":0.483,"65":0.417,"68":0.342,"69":0.274,"71":0.227,"73":0.252,"75":0.0521,"76":0.673,"78":0.0632},"danceability":{"0":0.529,"2":0.743,"3":0.571,"4":0.637,"6":0.911,"8":0.486,"9":0.838,"11":0.838,"14":0.772,"15":0.684,"16":0.699,"18":0.887,"20":0.865,"21":0.559,"22":0.683,"24":0.697,"25":0.516,"26":0.621,"28":0.954,"29":0.442,"30":0.515,"31":0.679,"33":0.464,"34":0.538,"36":0.492,"37":0.901,"39":0.804,"40":0.835,"41":0.772,"44":0.551,"46":0.784,"48":0.561,"50":0.928,"52":0.574,"53":0.718,"54":0.586,"55":0.712,"57":0.637,"58":0.585,"59":0.801,"61":0.783,"63":0.668,"65":0.715,"68":0.52,"69":0.778,"71":0.575,"73":0.696,"75":0.644,"76":0.72,"78":0.707},"duration_ms":{"0":271862,"2":168133,"3":132631,"4":193464,"6":178567,"8":123891,"9":128677,"11":161452,"14":165265,"15":195373,"16":224921,"18":196800,"20":155960,"21":201800,"22":160325,"24":148120,"25":182888,"26":198938,"28":139560,"29":244360,"30":209260,"31":230453,"33":183956,"34":272373,"36":163855,"37":196600,"39":212253,"40":162638,"41":174943,"44":176440,"46":184066,"48":175238,"50":265000,"52":242485,"53":221407,"54":260253,"55":156943,"57":200690,"58":200930,"59":239318,"61":216148,"63":165671,"65":221520,"68":167303,"69":218289,"71":232857,"73":131013,"75":153947,"76":199440,"78":200455},"energy":{"0":0.602,"2":0.831,"3":0.544,"4":0.768,"6":0.712,"8":0.545,"9":0.708,"11":0.79,"14":0.75,"15":0.607,"16":0.541,"18":0.234,"20":0.573,"21":0.551,"22":0.764,"24":0.802,"25":0.322,"26":0.782,"28":0.516,"29":0.538,"30":0.593,"31":0.587,"33":0.417,"34":0.742,"36":0.675,"37":0.589,"39":0.771,"40":0.679,"41":0.73,"44":0.55,"46":0.826,"48":0.965,"50":0.468,"52":0.469,"53":0.467,"54":0.525,"55":0.463,"57":0.643,"58":0.815,"59":0.806,"61":0.729,"63":0.758,"65":0.62,"68":0.731,"69":0.632,"71":0.5,"73":0.809,"75":0.735,"76":0.63,"78":0.681},"instrumentalness":{"0":0.0,"2":0.0000643,"3":0.00805,"4":0.00192,"6":0.0000268,"8":0.00474,"9":0.0,"11":0.00000333,"14":0.0,"15":0.000307,"16":0.0,"18":0.67,"20":0.0,"21":0.0,"22":0.0,"24":0.0000355,"25":0.00194,"26":0.033,"28":0.00000754,"29":0.0000295,"30":0.162,"31":0.00000635,"33":0.022,"34":0.0000467,"36":0.0,"37":0.000237,"39":0.00000307,"40":0.00000198,"41":0.000107,"44":0.0,"46":0.0000709,"48":0.00000707,"50":0.00000427,"52":0.0000921,"53":0.0000692,"54":0.0,"55":0.00000296,"57":0.0000018,"58":0.0,"59":0.000669,"61":0.000272,"63":0.0000189,"65":0.0,"68":0.00101,"69":0.0,"71":0.0,"73":0.000128,"75":0.144,"76":0.0,"78":0.00000515},"key":{"0":7,"2":8,"3":6,"4":0,"6":1,"8":11,"9":5,"11":6,"14":5,"15":11,"16":0,"18":9,"20":5,"21":5,"22":2,"24":0,"25":9,"26":2,"28":6,"29":4,"30":4,"31":7,"33":0,"34":2,"36":6,"37":1,"39":9,"40":7,"41":11,"44":10,"46":7,"48":7,"50":2,"52":4,"53":2,"54":1,"55":2,"57":4,"58":0,"59":11,"61":6,"63":5,"65":1,"68":6,"69":2,"71":1,"73":5,"75":8,"76":4,"78":0},"liveness":{"0":0.0716,"2":0.35,"3":0.322,"4":0.378,"6":0.0933,"8":0.0642,"9":0.343,"11":0.184,"14":0.074,"15":0.191,"16":0.0916,"18":0.13,"20":0.305,"21":0.11,"22":0.0963,"24":0.0614,"25":0.215,"26":0.23,"28":0.0504,"29":0.09,"30":0.25,"31":0.137,"33":0.0974,"34":0.0934,"36":0.142,"37":0.0992,"39":0.108,"40":0.218,"41":0.274,"44":0.202,"46":0.123,"48":0.371,"50":0.0986,"52":0.128,"53":0.126,"54":0.134,"55":0.301,"57":0.142,"58":0.124,"59":0.114,"61":0.1,"63":0.0837,"65":0.0822,"68":0.311,"69":0.0915,"71":0.335,"73":0.248,"75":0.161,"76":0.0936,"78":0.0322},"loudness":{"0":-4.629,"2":-4.042,"3":-10.613,"4":-6.468,"6":-5.105,"8":-7.924,"9":-4.668,"11":-1.602,"14":-3.67,"15":-8.127,"16":-4.943,"18":-14.52,"20":-5.501,"21":-7.231,"22":-5.995,"24":-6.412,"25":-11.762,"26":-5.548,"28":-5.817,"29":-8.55,"30":-4.801,"31":-7.015,"33":-9.345,"34":-5.355,"36":-5.456,"37":-6.713,"39":-4.067,"40":-5.329,"41":-6.657,"44":-5.339,"46":-6.34,"48":-3.673,"50":-8.196,"52":-8.209,"53":-9.66,"54":-7.163,"55":-7.399,"57":-6.571,"58":-4.165,"59":-5.206,"61":-3.549,"63":-5.176,"65":-6.005,"68":-5.338,"69":-5.6,"71":-7.594,"73":-8.254,"75":-5.747,"76":-3.547,"78":-4.325},"speechiness":{"0":0.0458,"2":0.0584,"3":0.0299,"4":0.056,"6":0.0817,"8":0.0336,"9":0.166,"11":0.108,"14":0.0455,"15":0.1,"16":0.0826,"18":0.178,"20":0.0678,"21":0.132,"22":0.0441,"24":0.0456,"25":0.0292,"26":0.044,"28":0.16,"29":0.0451,"30":0.0322,"31":0.276,"33":0.0256,"34":0.114,"36":0.0389,"37":0.289,"39":0.0433,"40":0.0364,"41":0.0972,"44":0.0286,"46":0.0538,"48":0.0343,"50":0.364,"52":0.0254,"53":0.0398,"54":0.0615,"55":0.0797,"57":0.0519,"58":0.0565,"59":0.0381,"61":0.0691,"63":0.0332,"65":0.0484,"68":0.0557,"69":0.0493,"71":0.0707,"73":0.05,"75":0.0391,"76":0.277,"78":0.0668},"tempo":{"0":157.643,"2":95.975,"3":132.052,"4":94.982,"6":92.005,"8":150.187,"9":119.984,"11":92.927,"14":114.061,"15":81.001,"16":98.395,"18":140.02,"20":94.999,"21":143.008,"22":149.949,"24":139.951,"25":148.005,"26":128.033,"28":105.001,"29":122.758,"30":94.467,"31":186.003,"33":67.528,"34":96.107,"36":203.759,"37":98.002,"39":126.956,"40":124.98,"41":136.175,"44":101.19,"46":138.078,"48":128.04,"50":96.006,"52":132.023,"53":95.96,"54":133.629,"55":131.199,"57":97.008,"58":132.09,"59":106.999,"61":167.968,"63":147.989,"65":97.95,"68":173.93,"69":122.104,"71":67.033,"73":132.962,"75":88.98,"76":179.974,"78":117.999},"valence":{"0":0.756,"2":0.609,"3":0.216,"4":0.297,"6":0.425,"8":0.0385,"9":0.96,"11":0.962,"14":0.587,"15":0.498,"16":0.365,"18":0.197,"20":0.563,"21":0.392,"22":0.137,"24":0.822,"25":0.261,"26":0.55,"28":0.624,"29":0.139,"30":0.153,"31":0.486,"33":0.479,"34":0.25,"36":0.478,"37":0.399,"39":0.739,"40":0.85,"41":0.786,"44":0.342,"46":0.893,"48":0.304,"50":0.47,"52":0.288,"53":0.396,"54":0.508,"55":0.206,"57":0.533,"58":0.564,"59":0.802,"61":0.58,"63":0.834,"65":0.172,"68":0.662,"69":0.498,"71":0.506,"73":0.857,"75":0.418,"76":0.607,"78":0.646},"mode":{"0":1,"2":0,"3":1,"4":1,"6":0,"8":1,"9":0,"11":0,"14":0,"15":0,"16":1,"18":1,"20":1,"21":1,"22":1,"24":1,"25":1,"26":1,"28":1,"29":0,"30":1,"31":1,"33":0,"34":1,"36":1,"37":0,"39":0,"40":0,"41":0,"44":1,"46":0,"48":0,"50":1,"52":1,"53":1,"54":0,"55":1,"57":1,"58":0,"59":1,"61":0,"63":0,"65":0,"68":0,"69":0,"71":0,"73":1,"75":1,"76":0,"78":1}}
[2023-03-21T02:02:09.766+0000] {logging_mixin.py:137} INFO - ['song_name', 'track_id', 'is_explicit', 'acousticness', 'danceability', 'duration_ms', 'energy', 'instrumentalness', 'key', 'liveness', 'loudness', 'speechiness', 'tempo', 'valence', 'mode']
[2023-03-21T02:02:09.766+0000] {logging_mixin.py:137} INFO - song_dim
[2023-03-21T02:02:09.796+0000] {logging_mixin.py:137} INFO -                                             song_name  explicit  ...  valence  mode
0                                           Bebe Dame     False  ...   0.7560     1
2                              CHORRITO PA LAS ANIMAS      True  ...   0.6090     0
3                                   Romantic Homicide     False  ...   0.2160     1
4                          Tormenta (feat. Bad Bunny)      True  ...   0.2970     1
6                                     Me Porto Bonito      True  ...   0.4250     0
8                                     Just Wanna Rock      True  ...   0.0385     1
9                                            Rara Vez     False  ...   0.9600     0
11                                             MERCHO     False  ...   0.9620     0
14                                              Bones     False  ...   0.5870     0
15                                         Sure Thing     False  ...   0.4980     0
16                                      Fin de Semana     False  ...   0.3650     1
18                                           La Jumpa      True  ...   0.1970     1
20                            Feliz Cumplea√±os Ferxxo     False  ...   0.5630     1
21                                             Snooze      True  ...   0.3920     1
22                                        Coco Chanel      True  ...   0.1370     1
24                                    I Ain't Worried     False  ...   0.8220     1
25                                           ceilings     False  ...   0.2610     1
26              Quevedo: Bzrp Music Sessions, Vol. 52     False  ...   0.5500     1
28                                            Players      True  ...   0.6240     1
29                                       Another Love      True  ...   0.1390     0
30                                        golden hour     False  ...   0.1530     1
31                                            Starboy      True  ...   0.4860     1
33                                   I Wanna Be Yours     False  ...   0.4790     0
34                                          Escapism.      True  ...   0.2500     1
36                                         Last Night      True  ...   0.4780     1
37                                            Hey Mor     False  ...   0.3990     0
39                                                OMG     False  ...   0.7390     0
40                                         La Bachata     False  ...   0.8500     0
41                                                AMG      True  ...   0.7860     0
44  Until I Found You (with Em Beihold) - Em Beiho...     False  ...   0.3420     1
46                                                PRC      True  ...   0.8930     0
48                                    I'm Good (Blue)      True  ...   0.3040     0
50                                       Shorty Party      True  ...   0.4700     1
52                                       Here With Me     False  ...   0.2880     1
53                  All Of The Girls You Loved Before     False  ...   0.3960     1
54                                        Die For You     False  ...   0.5080     0
55                          Unholy (feat. Kim Petras)     False  ...   0.2060     1
57                                          Anti-Hero     False  ...   0.5330     1
58                                   Set Me Free Pt.2      True  ...   0.5640     0
59                      Calm Down (with Selena Gomez)     False  ...   0.8020     1
61                                         Yandel 150      True  ...   0.5800     0
63                                    Ella Baila Sola     False  ...   0.8340     0
65             Creepin' (with The Weeknd & 21 Savage)      True  ...   0.1720     0
68                                          As It Was     False  ...   0.6620     0
69              Shakira: Bzrp Music Sessions, Vol. 53     False  ...   0.4980     0
71           Die For You (with Ariana Grande) - Remix     False  ...   0.5060     0
73                                 Boy's a liar Pt. 2     False  ...   0.8570     1
75                                          Kill Bill     False  ...   0.4180     1
76                                                TQG      True  ...   0.6070     0
78                                            Flowers     False  ...   0.6460     1

[50 rows x 14 columns]
[2023-03-21T02:02:09.799+0000] {taskinstance.py:1775} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 192, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/src/transform.py", line 76, in validate_data
    raise ValueError("{} doesn't contain the correct rows".format(table))
ValueError: song_dim doesn't contain the correct rows
[2023-03-21T02:02:09.807+0000] {taskinstance.py:1326} INFO - Marking task as UP_FOR_RETRY. dag_id=Spotify_Data_ETL, task_id=ValidateAndLoadSongDim.ValidateSongDim, execution_date=20230318T042711, start_date=20230321T020209, end_date=20230321T020209
[2023-03-21T02:02:09.814+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 1624 for task ValidateAndLoadSongDim.ValidateSongDim (song_dim doesn't contain the correct rows; 16192)
[2023-03-21T02:02:09.858+0000] {local_task_job.py:212} INFO - Task exited with return code 1
[2023-03-21T02:02:09.882+0000] {taskinstance.py:2585} INFO - 0 downstream tasks scheduled from follow-on schedule check
