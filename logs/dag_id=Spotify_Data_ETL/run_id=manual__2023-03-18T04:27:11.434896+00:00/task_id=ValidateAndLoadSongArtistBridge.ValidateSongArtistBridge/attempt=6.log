[2023-03-21T02:02:41.138+0000] {taskinstance.py:1084} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge manual__2023-03-18T04:27:11.434896+00:00 [queued]>
[2023-03-21T02:02:41.144+0000] {taskinstance.py:1084} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge manual__2023-03-18T04:27:11.434896+00:00 [queued]>
[2023-03-21T02:02:41.144+0000] {taskinstance.py:1282} INFO - 
--------------------------------------------------------------------------------
[2023-03-21T02:02:41.147+0000] {taskinstance.py:1283} INFO - Starting attempt 6 of 6
[2023-03-21T02:02:41.148+0000] {taskinstance.py:1284} INFO - 
--------------------------------------------------------------------------------
[2023-03-21T02:02:41.158+0000] {taskinstance.py:1303} INFO - Executing <Task(PythonOperator): ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge> on 2023-03-18 04:27:11.434896+00:00
[2023-03-21T02:02:41.163+0000] {standard_task_runner.py:55} INFO - Started process 16246 to run task
[2023-03-21T02:02:41.168+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'Spotify_Data_ETL', 'ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge', 'manual__2023-03-18T04:27:11.434896+00:00', '--job-id', '1629', '--raw', '--subdir', 'DAGS_FOLDER/spotifydag.py', '--cfg-path', '/tmp/tmp08aeia5x']
[2023-03-21T02:02:41.169+0000] {standard_task_runner.py:83} INFO - Job 1629: Subtask ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge
[2023-03-21T02:02:41.245+0000] {task_command.py:388} INFO - Running <TaskInstance: Spotify_Data_ETL.ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge manual__2023-03-18T04:27:11.434896+00:00 [running]> on host 1fd7b08731f2
[2023-03-21T02:02:41.319+0000] {taskinstance.py:1511} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Ananta Moharana
AIRFLOW_CTX_DAG_ID=Spotify_Data_ETL
AIRFLOW_CTX_TASK_ID=ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge
AIRFLOW_CTX_EXECUTION_DATE=2023-03-18T04:27:11.434896+00:00
AIRFLOW_CTX_TRY_NUMBER=6
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-03-18T04:27:11.434896+00:00
[2023-03-21T02:02:41.321+0000] {logging_mixin.py:137} INFO - {"song_id":{"0":"0IKeDy5bT9G0bA7ZixRT4A","1":"0IKeDy5bT9G0bA7ZixRT4A","2":"0CYTGMBYkwUxrj1MWDLrC5","3":"1xK59OXxi2TAAAbmZK0kBL","4":"38UYeBLfvpnDSG9GznZdnL","5":"38UYeBLfvpnDSG9GznZdnL","6":"6Sq7ltF9Qa7SNFBsV5Cogx","7":"6Sq7ltF9Qa7SNFBsV5Cogx","8":"4FyesJzVpA39hbYvcseO2d","9":"7MVIfkyzuUmQ716j8U7yGR","10":"7MVIfkyzuUmQ716j8U7yGR","11":"1DxEbt6OSbrkRthk6pjZue","12":"1DxEbt6OSbrkRthk6pjZue","13":"1DxEbt6OSbrkRthk6pjZue","14":"54ipXppHLA8U4yqpOFTUhr","15":"0JXXNGljqupsJaZsgSbMZV","16":"6TBzRwnX2oYd8aOrOuyK1p","17":"6TBzRwnX2oYd8aOrOuyK1p","18":"2mnXxnrX5vCGolNkaFvVeM","19":"2mnXxnrX5vCGolNkaFvVeM","20":"2CeKVsFFXG4QzA415QygGb","21":"4iZ4pt7kvcaH6Yo8UoZ4s2","22":"0PB0O24JqAuNdOAFVJljMS","23":"0PB0O24JqAuNdOAFVJljMS","24":"4fYte8ZvTK14NEhAOZocBi","25":"2L9N0zZnd37dwF0clgxMGI","26":"2tTmW7RDtMQtBk7m2rYeSw","27":"2tTmW7RDtMQtBk7m2rYeSw","28":"6UN73IYd0hZxLi8wFPMQij","29":"7jtQIBanIiJOMS6RyCx6jZ","30":"5odlY52u43F5BjByhxg7wg","31":"7MXVkk9YMctZqd1Srtv4MB","32":"7MXVkk9YMctZqd1Srtv4MB","33":"5XeFesFbtLpXzIVDNQP22n","34":"5mHdCZtVyb4DcJw8799hZp","35":"5mHdCZtVyb4DcJw8799hZp","36":"7K3BhSpAxZBznislvUMVtn","37":"1zsPaEkglFvxjAhrM8yhpr","38":"1zsPaEkglFvxjAhrM8yhpr","39":"65FftemJ1DbbZ45DUfHJXE","40":"3tt9i3Hhzq84dPS8H7iSiJ","41":"1lRtH4FszTrwwlK5gTSbXO","42":"1lRtH4FszTrwwlK5gTSbXO","43":"1lRtH4FszTrwwlK5gTSbXO","44":"1Y3LN4zO1Edc2EluIoSPJN","45":"1Y3LN4zO1Edc2EluIoSPJN","46":"2mpoNBkngUEwnaKoBhZ0vl","47":"2mpoNBkngUEwnaKoBhZ0vl","48":"4uUG5RXrOk84mYEfFvj3cK","49":"4uUG5RXrOk84mYEfFvj3cK","50":"55ZATsjPlTeSTNJOuW90pW","51":"55ZATsjPlTeSTNJOuW90pW","52":"78Sw5GDo6AlGwTwanjXbGh","53":"4P9Q0GojKVXpRTJCaL3kyy","54":"2LBqCSwhJGcFQeTHMVGwy3","55":"0NZPBYD5qbEWRs3PrGiRkT","56":"0NZPBYD5qbEWRs3PrGiRkT","57":"0V3wPSX9ygBnCm8psDIegu","58":"59hBR0BCtJsfIbV9VzCVAp","59":"0WtM2NBVQNNJLh6scP13H8","60":"0WtM2NBVQNNJLh6scP13H8","61":"4FAKtPVycI4DxoOHC01YqD","62":"4FAKtPVycI4DxoOHC01YqD","63":"3dnP0JxCgygwQH9Gm7q7nb","64":"3dnP0JxCgygwQH9Gm7q7nb","65":"2dHHgzDwk4BJdRwy9uXhTO","66":"2dHHgzDwk4BJdRwy9uXhTO","67":"2dHHgzDwk4BJdRwy9uXhTO","68":"4Dvkj6JhhA12EX05fT7y2e","69":"4nrPB8O7Y7wsOCJdgXkthe","70":"4nrPB8O7Y7wsOCJdgXkthe","71":"4W4fNrZYkobj539TOWsLO2","72":"4W4fNrZYkobj539TOWsLO2","73":"6AQbmUe0Qwf5PZnt4HmTXv","74":"6AQbmUe0Qwf5PZnt4HmTXv","75":"1Qrg8KqiBpW07V7PNxwwwL","76":"0DWdj2oZMBFSzRsi2Cvfzf","77":"0DWdj2oZMBFSzRsi2Cvfzf","78":"4DHcnVTT87F0zZhRPYmZ3B"},"artist_id":{"0":"6XkjpgcEsYab502Vr1bBeW","1":"0ys2OFYzWYB5hRDLCsBqxt","2":"2LRoIwlKmHjgvigdNGBHNo","3":"5y8tKLUfMvliMe8IKamR32","4":"4q3ewBCX7sLwd24euuV69X","5":"3AA28KZvwAUcZuOKwyblJQ","6":"37230BxxYs9ksS7OkZw3IU","7":"4q3ewBCX7sLwd24euuV69X","8":"4O15NlyKLIASxsJ0PrXPfz","9":"19HM5j0ULGSmEoRcrSe5x3","10":"5szJHKg5xeUlQ9pTqzdpic","11":"0uxYECT7XqHNccQAg5Uhe4","12":"48R2gYdPKtfnfKAzhSVPUx","13":"0niAkxgT6y57bRbT0Ge94z","14":"53XhwfbYqKCa1cC15pYq2q","15":"360IAlyVv4PCEVjgyMZrxK","16":"7Gi6gjaWy3DxyilpF1a8Is","17":"3l9G1G9MxH6DaRhwLklaf5","18":"4q3ewBCX7sLwd24euuV69X","19":"4SsVbpTthjScTS7U2hmr1X","20":"2LRoIwlKmHjgvigdNGBHNo","21":"7tYKF4w9nC0nq9CsPZTHyP","22":"4q3ewBCX7sLwd24euuV69X","23":"5XJDexmWFLWOkjOEjOVX3e","24":"5Pwc4xIPtQLFEnJriah9YJ","25":"1GmsPCcpKgF9OhlNXjOsbS","26":"52iwsT98xCoGgiGntTiR7K","27":"716NhGYqD1jl2wI1Qkgq36","28":"6AMd49uBDJfhf30Ak2QR5s","29":"2txHhyCwHjUEpJjWrEyqyX","30":"164Uj4eKjl6zTBKfJLFKKK","31":"4tZwfgrHOc3mvqYlEYSvVi","32":"1Xyo4u8uXC1ZmMpatF05PJ","33":"7Ln80lUS6He07XvHI8qqHH","34":"12Zk1DFhCbHY6v3xep2ZjI","35":"5KKpBU5eC2tJDzf0wmlRp2","36":"4oUHIQIBe0LHzYfvXNW4QM","37":"2LRoIwlKmHjgvigdNGBHNo","38":"1i8SpTcr7yvPOmcqrbnVXY","39":"6HvZYsbFfjnjFrWF950C9d","40":"0tmwSHipWxN12fsoLcFU3B","41":"6Sbl0NT50roqWvy746MfVf","42":"12GqGscKJx3aE4t07u7eVZ","43":"0elWFr7TW8piilVRYJUe4P","44":"7o2ZQYM7nTsaVdkXY38UAA","45":"5XKFrudbV4IiuE5WuTPRmT","46":"0elWFr7TW8piilVRYJUe4P","47":"12GqGscKJx3aE4t07u7eVZ","48":"64M6ah0SkkRsnPGtGiRAbb","49":"1Cs0zKBU1kc0i8ypK3B9ai","50":"4yEIQ0lJDgUEfsuYx3Gsmr","51":"07PdYoE4jVRF6Ut40GgVSP","52":"5y8tKLUfMvliMe8IKamR32","53":"06HL4z0CvFAxyc27GXpf02","54":"1Xyo4u8uXC1ZmMpatF05PJ","55":"3Xt3RrJMFv5SZkCfUE8C1J","56":"2wY79sveU1sp5g7SokKOiI","57":"06HL4z0CvFAxyc27GXpf02","58":"1oSPZhvZMIrWW5I41kPkkY","59":"0C8ZW7ezQVs4URX5aX7Kqx","60":"46pWGuE3dSwY3bMMXGBvVS","61":"2LRoIwlKmHjgvigdNGBHNo","62":"0eHQ9o50hj6ZDNBt6Ys1sD","63":"12GqGscKJx3aE4t07u7eVZ","64":"0XeEobZplHxzM9QzFQWLiR","65":"1URnnhqYAYcrqrcwql10ft","66":"1Xyo4u8uXC1ZmMpatF05PJ","67":"0iEtIxbK0KxaSlF7G42ZOp","68":"6KImCVD70vtIoJWnq6nGn3","69":"0EmeFodog0BfCgMzAIvKQp","70":"716NhGYqD1jl2wI1Qkgq36","71":"66CXWjxzNUsdJxJ2JdwvnR","72":"1Xyo4u8uXC1ZmMpatF05PJ","73":"3LZZPxNDGDFVSIPqf4JuEf","74":"78rUTD7y6Cy67W1RVzYs7t","75":"7tYKF4w9nC0nq9CsPZTHyP","76":"0EmeFodog0BfCgMzAIvKQp","77":"790FomKkXshlbRYZFtlgla","78":"5YGY8feqx7naU7z4HrwZM6"}}
[2023-03-21T02:02:41.321+0000] {logging_mixin.py:137} INFO - ['track_id', 'artist_id']
[2023-03-21T02:02:41.322+0000] {logging_mixin.py:137} INFO - song_artist_bridge
[2023-03-21T02:02:41.337+0000] {logging_mixin.py:137} INFO -                    song_id               artist_id
0   0IKeDy5bT9G0bA7ZixRT4A  6XkjpgcEsYab502Vr1bBeW
1   0IKeDy5bT9G0bA7ZixRT4A  0ys2OFYzWYB5hRDLCsBqxt
2   0CYTGMBYkwUxrj1MWDLrC5  2LRoIwlKmHjgvigdNGBHNo
3   1xK59OXxi2TAAAbmZK0kBL  5y8tKLUfMvliMe8IKamR32
4   38UYeBLfvpnDSG9GznZdnL  4q3ewBCX7sLwd24euuV69X
..                     ...                     ...
74  6AQbmUe0Qwf5PZnt4HmTXv  78rUTD7y6Cy67W1RVzYs7t
75  1Qrg8KqiBpW07V7PNxwwwL  7tYKF4w9nC0nq9CsPZTHyP
76  0DWdj2oZMBFSzRsi2Cvfzf  0EmeFodog0BfCgMzAIvKQp
77  0DWdj2oZMBFSzRsi2Cvfzf  790FomKkXshlbRYZFtlgla
78  4DHcnVTT87F0zZhRPYmZ3B  5YGY8feqx7naU7z4HrwZM6

[79 rows x 2 columns]
[2023-03-21T02:02:41.339+0000] {taskinstance.py:1775} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 192, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/src/transform.py", line 76, in validate_data
    raise ValueError("{} doesn't contain the correct rows".format(table))
ValueError: song_artist_bridge doesn't contain the correct rows
[2023-03-21T02:02:41.347+0000] {taskinstance.py:1326} INFO - Marking task as FAILED. dag_id=Spotify_Data_ETL, task_id=ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge, execution_date=20230318T042711, start_date=20230321T020241, end_date=20230321T020241
[2023-03-21T02:02:41.355+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 1629 for task ValidateAndLoadSongArtistBridge.ValidateSongArtistBridge (song_artist_bridge doesn't contain the correct rows; 16246)
[2023-03-21T02:02:41.379+0000] {local_task_job.py:212} INFO - Task exited with return code 1
[2023-03-21T02:02:41.404+0000] {taskinstance.py:2585} INFO - 0 downstream tasks scheduled from follow-on schedule check
