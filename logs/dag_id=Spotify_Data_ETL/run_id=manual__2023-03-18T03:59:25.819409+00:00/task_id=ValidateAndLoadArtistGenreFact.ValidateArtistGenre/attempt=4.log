[2023-03-18T04:10:45.400+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: Spotify_Data_ETL.ValidateAndLoadArtistGenreFact.ValidateArtistGenre manual__2023-03-18T03:59:25.819409+00:00 [queued]>
[2023-03-18T04:10:45.408+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: Spotify_Data_ETL.ValidateAndLoadArtistGenreFact.ValidateArtistGenre manual__2023-03-18T03:59:25.819409+00:00 [queued]>
[2023-03-18T04:10:45.408+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2023-03-18T04:10:45.409+0000] {taskinstance.py:1280} INFO - Starting attempt 4 of 5
[2023-03-18T04:10:45.409+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2023-03-18T04:10:45.421+0000] {taskinstance.py:1300} INFO - Executing <Task(PythonOperator): ValidateAndLoadArtistGenreFact.ValidateArtistGenre> on 2023-03-18 03:59:25.819409+00:00
[2023-03-18T04:10:45.432+0000] {standard_task_runner.py:55} INFO - Started process 1232 to run task
[2023-03-18T04:10:45.449+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'Spotify_Data_ETL', 'ValidateAndLoadArtistGenreFact.ValidateArtistGenre', 'manual__2023-03-18T03:59:25.819409+00:00', '--job-id', '1417', '--raw', '--subdir', 'DAGS_FOLDER/spotifydag.py', '--cfg-path', '/tmp/tmpgyf28kuh']
[2023-03-18T04:10:45.450+0000] {standard_task_runner.py:83} INFO - Job 1417: Subtask ValidateAndLoadArtistGenreFact.ValidateArtistGenre
[2023-03-18T04:10:45.650+0000] {task_command.py:388} INFO - Running <TaskInstance: Spotify_Data_ETL.ValidateAndLoadArtistGenreFact.ValidateArtistGenre manual__2023-03-18T03:59:25.819409+00:00 [running]> on host d7c7ac56d661
[2023-03-18T04:10:45.775+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=Ananta Moharana
AIRFLOW_CTX_DAG_ID=Spotify_Data_ETL
AIRFLOW_CTX_TASK_ID=ValidateAndLoadArtistGenreFact.ValidateArtistGenre
AIRFLOW_CTX_EXECUTION_DATE=2023-03-18T03:59:25.819409+00:00
AIRFLOW_CTX_TRY_NUMBER=4
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-03-18T03:59:25.819409+00:00
[2023-03-18T04:10:45.782+0000] {logging_mixin.py:137} INFO - {"artist_id":{"0":"5lwmRuXgjX8xIwlnauTZIP","1":"6KImCVD70vtIoJWnq6nGn3","2":"164Uj4eKjl6zTBKfJLFKKK","3":"0tmwSHipWxN12fsoLcFU3B","4":"0tmwSHipWxN12fsoLcFU3B","5":"0tmwSHipWxN12fsoLcFU3B","6":"0tmwSHipWxN12fsoLcFU3B","7":"0tmwSHipWxN12fsoLcFU3B","8":"4O15NlyKLIASxsJ0PrXPfz","9":"4O15NlyKLIASxsJ0PrXPfz","10":"4O15NlyKLIASxsJ0PrXPfz","11":"4O15NlyKLIASxsJ0PrXPfz","12":"2LRoIwlKmHjgvigdNGBHNo","13":"2LRoIwlKmHjgvigdNGBHNo","14":"2LRoIwlKmHjgvigdNGBHNo","15":"2LRoIwlKmHjgvigdNGBHNo","16":"0eHQ9o50hj6ZDNBt6Ys1sD","17":"0eHQ9o50hj6ZDNBt6Ys1sD","18":"0eHQ9o50hj6ZDNBt6Ys1sD","19":"2txHhyCwHjUEpJjWrEyqyX","20":"2txHhyCwHjUEpJjWrEyqyX","21":"6Sbl0NT50roqWvy746MfVf","22":"6Sbl0NT50roqWvy746MfVf","23":"7tYKF4w9nC0nq9CsPZTHyP","24":"7tYKF4w9nC0nq9CsPZTHyP","25":"2R21vXR83lH98kGeO99Y66","26":"2R21vXR83lH98kGeO99Y66","27":"2R21vXR83lH98kGeO99Y66","28":"2R21vXR83lH98kGeO99Y66","29":"2R21vXR83lH98kGeO99Y66","30":"7o2ZQYM7nTsaVdkXY38UAA","31":"7o2ZQYM7nTsaVdkXY38UAA","32":"4oUHIQIBe0LHzYfvXNW4QM","33":"5Pwc4xIPtQLFEnJriah9YJ","34":"5Pwc4xIPtQLFEnJriah9YJ","35":"1Xyo4u8uXC1ZmMpatF05PJ","36":"1Xyo4u8uXC1ZmMpatF05PJ","37":"1Xyo4u8uXC1ZmMpatF05PJ","38":"0elWFr7TW8piilVRYJUe4P","39":"0elWFr7TW8piilVRYJUe4P","40":"0elWFr7TW8piilVRYJUe4P","41":"0elWFr7TW8piilVRYJUe4P","42":"0elWFr7TW8piilVRYJUe4P","43":"0elWFr7TW8piilVRYJUe4P","44":"06HL4z0CvFAxyc27GXpf02","45":"6HvZYsbFfjnjFrWF950C9d","46":"6HvZYsbFfjnjFrWF950C9d","47":"1i8SpTcr7yvPOmcqrbnVXY","48":"1i8SpTcr7yvPOmcqrbnVXY","49":"1i8SpTcr7yvPOmcqrbnVXY","50":"1i8SpTcr7yvPOmcqrbnVXY","51":"12GqGscKJx3aE4t07u7eVZ","52":"4tZwfgrHOc3mvqYlEYSvVi","53":"4tZwfgrHOc3mvqYlEYSvVi","54":"3TVXtAsR1Inumwj472S9r4","55":"3TVXtAsR1Inumwj472S9r4","56":"3TVXtAsR1Inumwj472S9r4","57":"3TVXtAsR1Inumwj472S9r4","58":"3TVXtAsR1Inumwj472S9r4","59":"0iEtIxbK0KxaSlF7G42ZOp","60":"48R2gYdPKtfnfKAzhSVPUx","61":"46pWGuE3dSwY3bMMXGBvVS","62":"1GmsPCcpKgF9OhlNXjOsbS","63":"1GmsPCcpKgF9OhlNXjOsbS","64":"1GmsPCcpKgF9OhlNXjOsbS","65":"12Zk1DFhCbHY6v3xep2ZjI","66":"4SsVbpTthjScTS7U2hmr1X","67":"4SsVbpTthjScTS7U2hmr1X","68":"4SsVbpTthjScTS7U2hmr1X","69":"3Xt3RrJMFv5SZkCfUE8C1J","70":"3Xt3RrJMFv5SZkCfUE8C1J","71":"3Xt3RrJMFv5SZkCfUE8C1J","72":"3Xt3RrJMFv5SZkCfUE8C1J","73":"3Xt3RrJMFv5SZkCfUE8C1J","74":"07PdYoE4jVRF6Ut40GgVSP","75":"07PdYoE4jVRF6Ut40GgVSP","76":"2wY79sveU1sp5g7SokKOiI","77":"2wY79sveU1sp5g7SokKOiI","78":"360IAlyVv4PCEVjgyMZrxK","79":"360IAlyVv4PCEVjgyMZrxK","80":"360IAlyVv4PCEVjgyMZrxK","81":"64aJYyrXljOodnUG6jvhRD","82":"64aJYyrXljOodnUG6jvhRD","83":"64aJYyrXljOodnUG6jvhRD","84":"64aJYyrXljOodnUG6jvhRD","85":"64aJYyrXljOodnUG6jvhRD","86":"2T1aUibqR2QC2sINIDQOAK","87":"5y8tKLUfMvliMe8IKamR32","88":"66CXWjxzNUsdJxJ2JdwvnR","89":"66CXWjxzNUsdJxJ2JdwvnR","90":"5YGY8feqx7naU7z4HrwZM6","91":"7dGJo4pcD2V6oG8kP0tJRR","92":"7dGJo4pcD2V6oG8kP0tJRR","93":"7dGJo4pcD2V6oG8kP0tJRR","94":"1Cs0zKBU1kc0i8ypK3B9ai","95":"1Cs0zKBU1kc0i8ypK3B9ai","96":"1Cs0zKBU1kc0i8ypK3B9ai","97":"1Cs0zKBU1kc0i8ypK3B9ai","98":"1Cs0zKBU1kc0i8ypK3B9ai","99":"790FomKkXshlbRYZFtlgla","100":"790FomKkXshlbRYZFtlgla","101":"790FomKkXshlbRYZFtlgla","102":"7Ln80lUS6He07XvHI8qqHH","103":"7Ln80lUS6He07XvHI8qqHH","104":"7Ln80lUS6He07XvHI8qqHH","105":"7Ln80lUS6He07XvHI8qqHH","106":"7Ln80lUS6He07XvHI8qqHH","107":"5KKpBU5eC2tJDzf0wmlRp2","108":"5KKpBU5eC2tJDzf0wmlRp2","109":"5KKpBU5eC2tJDzf0wmlRp2","110":"5XKFrudbV4IiuE5WuTPRmT","111":"5XKFrudbV4IiuE5WuTPRmT","112":"1URnnhqYAYcrqrcwql10ft","113":"1URnnhqYAYcrqrcwql10ft","114":"0EmeFodog0BfCgMzAIvKQp","115":"0EmeFodog0BfCgMzAIvKQp","116":"0EmeFodog0BfCgMzAIvKQp","117":"3AA28KZvwAUcZuOKwyblJQ","118":"52iwsT98xCoGgiGntTiR7K","119":"53XhwfbYqKCa1cC15pYq2q","120":"53XhwfbYqKCa1cC15pYq2q","121":"64M6ah0SkkRsnPGtGiRAbb","122":"64M6ah0SkkRsnPGtGiRAbb","123":"64M6ah0SkkRsnPGtGiRAbb","124":"64M6ah0SkkRsnPGtGiRAbb","125":"0C8ZW7ezQVs4URX5aX7Kqx","126":"0C8ZW7ezQVs4URX5aX7Kqx","127":"0C8ZW7ezQVs4URX5aX7Kqx","128":"37230BxxYs9ksS7OkZw3IU","129":"0niAkxgT6y57bRbT0Ge94z","130":"0niAkxgT6y57bRbT0Ge94z","131":"6AMd49uBDJfhf30Ak2QR5s","132":"6AMd49uBDJfhf30Ak2QR5s","133":"6AMd49uBDJfhf30Ak2QR5s","134":"6AMd49uBDJfhf30Ak2QR5s","135":"716NhGYqD1jl2wI1Qkgq36","136":"716NhGYqD1jl2wI1Qkgq36","137":"716NhGYqD1jl2wI1Qkgq36","138":"716NhGYqD1jl2wI1Qkgq36","139":"716NhGYqD1jl2wI1Qkgq36","140":"4q3ewBCX7sLwd24euuV69X","141":"4q3ewBCX7sLwd24euuV69X","142":"4q3ewBCX7sLwd24euuV69X","143":"7bXgB6jMjp9ATFy66eO08Z","144":"7bXgB6jMjp9ATFy66eO08Z"},"genre":{"0":"bachata","1":"pop","2":"modern indie pop","3":"urbano latino","4":"reggaeton colombiano","5":"reggaeton","6":"latin pop","7":"colombian pop","8":"trap","9":"rap","10":"philly rap","11":"melodic rap","12":"urbano latino","13":"reggaeton colombiano","14":"pop reggaeton","15":"colombian pop","16":"urbano latino","17":"reggaeton","18":"latin hip hop","19":"pop","20":"chill pop","21":"nueva musica mexicana","22":"corrido","23":"r&b","24":"pop","25":"urbano latino","26":"trap latino","27":"trap boricua","28":"reggaeton flow","29":"reggaeton","30":"gen z singer-songwriter","31":"alt z","32":"contemporary country","33":"pop","34":"piano rock","35":"pop","36":"canadian pop","37":"canadian contemporary r&b","38":"sierreno","39":"sad sierreno","40":"nueva musica mexicana","41":"musica mexicana","42":"corridos tumbados","43":"corrido","44":"pop","45":"k-pop girl group","46":"k-pop","47":"urbano latino","48":"trap latino","49":"reggaeton","50":"puerto rican pop","51":"sad sierreno","52":"filter house","53":"electro","54":"toronto rap","55":"rap","56":"hip hop","57":"canadian pop","58":"canadian hip hop","59":"rap","60":"cumbia pop","61":"nigerian pop","62":"pop","63":"indie pop","64":"boston folk","65":"new jersey rap","66":"urbano latino","67":"reggaeton","68":"latin hip hop","69":"transpop","70":"post-teen pop","71":"pop","72":"electropop","73":"dance pop","74":"mexican hip hop","75":"latin hip hop","76":"uk pop","77":"pop","78":"r&b","79":"pop","80":"dance pop","81":"urbano latino","82":"trap latino","83":"reggaeton flow","84":"reggaeton","85":"latin hip hop","86":"reggaeton flow","87":"bedroom pop","88":"pop","89":"dance pop","90":"pop","91":"rap","92":"hip hop","93":"detroit hip hop","94":"pop dance","95":"pop","96":"edm","97":"dance pop","98":"big room","99":"urbano latino","100":"reggaeton colombiano","101":"reggaeton","102":"sheffield indie","103":"rock","104":"permanent wave","105":"modern rock","106":"garage rock","107":"uk contemporary r&b","108":"pop","109":"dance pop","110":"pop","111":"gen z singer-songwriter","112":"rap","113":"atl hip hop","114":"latin pop","115":"dance pop","116":"colombian pop","117":"alternative hip hop","118":"rap canario","119":"rock","120":"modern rock","121":"post-teen pop","122":"pop","123":"edm","124":"dance pop","125":"post-teen pop","126":"pop","127":"dance pop","128":"reggaeton flow","129":"trap triste","130":"trap argentino","131":"viral rap","132":"trap queen","133":"rap","134":"new jersey underground rap","135":"urbano latino","136":"trap latino","137":"trap argentino","138":"pop venezolano","139":"argentine hip hop","140":"urbano latino","141":"trap latino","142":"reggaeton","143":"r&b","144":"dance pop"}}
[2023-03-18T04:10:45.783+0000] {logging_mixin.py:137} INFO - ['artist_id', 'genre']
[2023-03-18T04:10:45.784+0000] {logging_mixin.py:137} INFO - artist_genre_bfact
[2023-03-18T04:10:45.864+0000] {logging_mixin.py:137} INFO -                   artist_id                 genre
0    5lwmRuXgjX8xIwlnauTZIP               bachata
1    6KImCVD70vtIoJWnq6nGn3                   pop
2    164Uj4eKjl6zTBKfJLFKKK      modern indie pop
3    0tmwSHipWxN12fsoLcFU3B         urbano latino
4    0tmwSHipWxN12fsoLcFU3B  reggaeton colombiano
..                      ...                   ...
140  4q3ewBCX7sLwd24euuV69X         urbano latino
141  4q3ewBCX7sLwd24euuV69X           trap latino
142  4q3ewBCX7sLwd24euuV69X             reggaeton
143  7bXgB6jMjp9ATFy66eO08Z                   r&b
144  7bXgB6jMjp9ATFy66eO08Z             dance pop

[145 rows x 2 columns]
[2023-03-18T04:10:45.868+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 192, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/src/transform.py", line 73, in validate_data
    if len(data_table.drop_duplicates(inplace=True)) != len(data_table):
TypeError: object of type 'NoneType' has no len()
[2023-03-18T04:10:45.886+0000] {taskinstance.py:1323} INFO - Marking task as UP_FOR_RETRY. dag_id=Spotify_Data_ETL, task_id=ValidateAndLoadArtistGenreFact.ValidateArtistGenre, execution_date=20230318T035925, start_date=20230318T041045, end_date=20230318T041045
[2023-03-18T04:10:45.894+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 1417 for task ValidateAndLoadArtistGenreFact.ValidateArtistGenre (object of type 'NoneType' has no len(); 1232)
[2023-03-18T04:10:45.934+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2023-03-18T04:10:45.952+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
